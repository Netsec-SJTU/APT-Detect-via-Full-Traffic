#!/usr/bin/env python
# -*- coding:utf-8 -*-

from sqlalchemy import and_
from sqlalchemy import Column, BOOLEAN, VARCHAR, INT
from sqlalchemy.sql import func

from schema.tables.base import BaseTable
from common.utils import guid


class Malware(BaseTable):

    __tablename__ = 'malware'

    uid = Column(VARCHAR(32), primary_key=True, default=guid)
    md5 = Column(VARCHAR(32))
    sha1 = Column(VARCHAR(64))
    mtype = Column(VARCHAR(600))

    @classmethod
    def add(cls, db, md5, sha1, mtype):
        m = Malware()
        m.md5 = md5
        m.sha1 = sha1
        m.mtype = mtype
        db.add(m)
        db.commit()
        return True
