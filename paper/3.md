第三章 攻击检测技术原理

3.1 流量提取技术

3.1.1 HTTP流提取

从流量中以HTTP交互为单位提取请求

3.1.2 文件提取

在流量中，另外一个重要的信息是通过网络传输的多种文件。这些文件都不是整块传输的。而是各个协议。比如ftp的传输，http的上传下载文件，smtp的下载文件。

3.2 基于特征匹配的检测

3.2.1 开源waf

从开源的waf[git上的waf]中提取信息，形成IoC。

3.2.2 攻击工具

通过Metasploit中，从网络收集的漏洞执行攻击负载的流量能进行识别且对应的漏洞名称，对已知攻击来源进行报警。

通过Golismero、Nikto、Lynsis、unix-privesc-check、namp、Nessus等扫描工具探测主机信息进行识别并记录以下相关探测信息：计算机服务、端口、操作系统、软件版本等。

通过web扫描工具：apache-users、cutycapt、DIRB、dirbuster、vega、webslayer、WVS进行web扫描时进行关注并记录。

使用sqlmap、菜刀连接器、get webshell、post webshell进行识别告警。

3.2.3 APT IoC

3.3 基于沙箱的动态分析

3.4 基于机器学习的攻击检测 

3.4.1 特征提取

3.4.2 隐蔽加密流量识别告警

针对一些常规端口如80（http）、25（smtp）、110（pop）、53（dns）等进行非常规协议的加密流量传输。通过模型能有效识别出这种隐蔽加密流量并进行告警。

3.4.3 可疑加密流量证书识别及提取
提取出443端口与未知端口的ssl证书，需要识别未知端口是否是ssl协议，如果是解码为ssl协议后提取出通讯证书，并对提取的证书进行md5效验。

3.4.4 异常外联流量识别告警

对异常时间、主动外联IP进行识别与告警

畸形数据包、流量异常识别告警

通过网络中错误数据包、重发数据包、畸形数据包及全流量进行每日统计、分析、比对历史流量进行自定义阀值区间编辑，超出阀值区间流量进行告警。

3.4.2 ANN机器学习

ANN是多层神经元组成的，每层神经元都通过突触连接。

ANN的神经元有两种，显层和隐层。显层接受一个向量作为输入，然后可以用一个值作为偏移。
