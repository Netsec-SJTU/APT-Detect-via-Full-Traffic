4. APT攻击检测技术

4.1 常规攻击识别模型

通过对之前特征的提取，我们建立了对常规攻击的识别模型。

4.2 已知APT攻击识别模型

4.2.1 各APT攻击特征

通过阅读大量的apt分析报告[git上那个apt notes]，我们发现，apt攻击主要有下面这些特征：

- 目录 apt攻击通常会在特定的目录或者位置生成文件 
- dirver 使用驱动
- domain 通信域名
- hash 文件的哈希
- file 文件名文件
- reg 用于识别的注册表
- service 服务

4.3 未知APT攻击识别模型

4.3.1 隐蔽加密流量识别

针对一些常规端口如80（http）、25（smtp）、110（pop）、53（dns）等进行非常规协议的加密流量传输。通过模型能有效识别出这种隐蔽加密流量并进行告警。

4.3.2 劫持行为识别告警

主要是针对Arp协议劫持、dns域名解析劫持、dhcp、host与referer不一致的劫持识别与告警。

7)  DDOS、DNS流量放大攻击识别告警

针对DDOS、DNS流量放大攻击的识别与告警，识别出攻击流量的大小、持续时间、攻击或被IP。

8)  木马心跳识别告警

木马连接心跳记录间隔时间、心跳特点、C&C IP。

9)  可疑加密流量证书识别及提取

提取出443端口与未知端口的ssl证书，需要识别未知端口是否是ssl协议，如果是解码为ssl协议后提取出通讯证书，并对提取的证书进行md5效验。

10) 异常外联流量识别告警

对异常时间、主动外联IP进行识别与告警。

11) 畸形数据包、流量异常识别告警

通过网络中错误数据包、重发数据包、畸形数据包及全流量进行每日统计、分析、比对历史流量进行自定义阀值区间编辑，超出阀值区间流量进行告警。




4.4 本章小结

